@main("SimMapEditor") {
    <script type="application/javascript">
            $(document).ready( function() {
                var baseMap = L.tileLayer('http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                    minZoom: 3,
                    maxZoom: 18
                });
                var baseMap_de = L.tileLayer('http://{s}.tile.openstreetmap.de/tiles/osmde/{z}/{x}/{y}.png', {
                    minZoom: 3,
                    maxZoom: 18
                })
                var OpenStreetMap_BlackAndWhite = L.tileLayer('http://{s}.tiles.wmflabs.org/bw-mapnik/{z}/{x}/{y}.png', {
                    minZoom: 3,
                    maxZoom: 18
                });
                var MapBox = L.tileLayer('http://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token={accessToken}', {
                    subdomains: 'abcd',
                    id: 'mapbox.streets',
                    accessToken: 'pk.eyJ1IjoiZjNrZWxsZXIiLCJhIjoiY2lsa3VyNjB3MDA3am5ja3FxNHFld3E2NiJ9.A99UzeLIycU2I8jRCPixgg'
                });
                var map = new L.Map("map", {center: [-33.5, -70.6], zoom: 8, layers: [baseMap],
                    attributionControl: false, zoomControl: false});
                map.on("click", function(){
                    var streetDetails=$("#streetDetails")
                    var scope = angular.element(streetDetails).scope();
                    scope.updateFeature(null, null, null, map);
                });
                var svg = d3.select(map.getPanes().overlayPane).append("svg"),
                        g = svg.append("g").attr("class", "leaflet-zoom-hide");
                /*d3.json("@routes.Assets.at("json/santiago.json")", function(error, collection) {
                    if (error) throw console.log(error);

                    var santiago = L.geoJson(collection, {onEachFeature: onEachFeature});
                    addOverLay(santiago, "Santiago");
                });

                d3.json("@routes.Assets.at("json/siouxfalls.json")", function(error, collection) {
                    if (error) throw console.log(error);

                    var siouxfalls = L.geoJson(collection, {onEachFeature: onEachFeature});
                    addOverLay(siouxfalls, "Siouxfalls"); //TODO: QuadTile Intersection Algorithm!!!
                });*/

                //var geojsonURL = 'http://152.96.56.47:4000{s}/api/quadtile/1/{z}/{x}/{y}';
                var geojsonURL = 'http://localhost:9001/api/quadtile/1/{z}/{x}/{y}';
                var geojsonTileLayer = new L.TileLayer.GeoJSON(geojsonURL,{
                    clipTiles: false,
                    unique: function (feature) {
                        return feature.properties.id;
                    },
                    subdomains: ["5", "6", "7"]
                },{
                    onEachFeature: onEachFeature
                });

                function onEachFeature(feature, layer){
                    if (feature.properties) {
                        layer.setStyle({color: "red"});
                        layer.on("click", function(e){
                            var streetDetails = $("#streetDetails");
                            var scope = angular.element(streetDetails).scope();
                            scope.updateFeature(feature, layer, e.latlng, map);
                        });
                    }
                }

                var baseLayers = { "Color": baseMap, "Color_DE": baseMap_de,
                    "Black and White": OpenStreetMap_BlackAndWhite, "MapBox": MapBox};

                var basicControl = L.control.layers(baseLayers, {}).addTo(map);
                L.control.attribution(null);
                map.addControl(new L.Control.Zoomslider( {position: "bottomright"} ));
                L.control.scale( {position: "bottomleft", imperial: false} ).addTo(map);
                addOverLay(geojsonTileLayer, "Test Layer");

                L.easyButton({ position:"topright",states:[{onClick: function(btn, map){
                    $("#importMenu").offcanvas("show");
                },icon:'glyphicon-import'}]}).addTo(map);

                function addOverLay(layer, name) {
                    map.addLayer(layer);
                    basicControl.addOverlay(layer, name);
                }
            });
    </script>
}
<div id="mapContainer" class="container-fluid">
    <div class="row">
        <div id="map" class="col-xs-12">

        </div>
        <div id="importMenu" class="col-xs-3 navmenu-fixed-right offcanvas offcanvas-container" data-canvas=".leaflet-right">
            <div class="panel panel-default">
                <div class="panel-heading">XML Import</div>
                <div class="panel-body">
                    <!-- <form action="http://152.96.56.47:40005/api/xml" method="post" enctype="multipart/form-data"> -->
                    <form action="http://localhost:9001/api/xml" method="post" enctype="multipart/form-data">
                        <p>
                                    Network name : <input type="text" name="name">
                                </p>
                        <p>
                                    Choose a file : <input type="file" name="file" />
                                </p>
                        <p>
                                    Choose a format :
                            <select name="format">
                                <option value="WGS84">WGS84</option>
                                <option value="EPSG:3857">EPSG:3857</option>
                                <option value="EPSG:21781">EPSG:21781</option>
                                <option value="EPSG:26914">EPSG:26914</option>
                                <option value="EPSG:32719">EPSG:32719</option>
                            </select>
                        </p>
                        <input type="submit" value="Upload" />
                    </form>
                </div>
            </div>
        </div>
        <div id="streetDetails" class="col-xs-3 navmenu-fixed-right offcanvas offcanvas-container" data-canvas=".leaflet-right" ng-controller="StreetDetailController">
            <div class="panel panel-default">
                <div class="panel-heading">Properties</div>
                <div class="panel-body">
                    <table class="table">
                        <tbody>
                            <tr>
                                <th>ID</th>
                                <td>{{streetModel.properties.id}}</td>
                            </tr>
                            <tr>
                                <th>Oneway</th>
                                <td>{{streetModel.properties.oneway}}</td>
                            </tr>
                            <tr>
                                <th>Modes</th>
                                <td>{{streetModel.properties.modes}}</td>
                            </tr>
                            <tr>
                                <th>Length</th>
                                <td>{{streetModel.properties.length}}</td>
                            </tr>
                            <tr>
                                <th>Freespeed</th>
                                <td>{{streetModel.properties.freespeed}}</td>
                            </tr>
                            <tr>
                                <th>Permlanes</th>
                                <td>{{streetModel.properties.permlanes}}</td>
                            </tr>
                            <tr>
                                <th>Capacity</th>
                                <td>{{streetModel.properties.capacity}}</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="panel panel-default">
                <div class="panel-heading">Geometry</div>
                <div class="panel-body">
                    <table class="table">
                        <tbody>
                            <tr>
                                <th>Coordinates</th>
                                <td>{{streetModel.geometry.coordinates}}</td>
                            </tr>
                            <tr>
                                <th>Type</th>
                                <td>{{streetModel.geometry.type}}</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>